---
title: "국내 여행 참여자의 차이는 직업에 따라 달라지는가?"
output: github_document
---



##<서론>

### 초록

근래의 국내 여행 시장 약화 추세로 인해 국내 여행 진흥을 위한 다양한 시도가 이루어지고 있다. 그만큼 실질적인 국내 여행 참가자들의 데이터의 중요성도 높아졌기에 이를 알아봄으로써 국내 여행자들의 특성에 대해 파악을 할 수 있다. 본 보고서는 국내의 여러 지역으로 여행을 하는 여행자들은 어떤 특성을 가지고 있는지 알아보고, 다양한 특성들에 따른 여행자의 수와의 관계를 분석하고자 한다. KOSIS 국가 통계 포털에 나와있는 "여행지별 국내여행 참가 횟수(2014~).xlsx" 파일을 사용하여 분석을 진행하였다. 분석은 데이터를 불러오고 정제하는 단계, 분석에 필요한 형식으로 수정하고 가공하는 단계, 그래프로 가동된 데이터를 파악하는 단계로 크게 3가지 절차로 분석하였다. 

직업별 여행자수를 분석한 결과 연도별로는, 전문직인 여행자가 많이 나타났고, 지역별로는 광주의 경우 다른 지역에 비해 `농어업`직업군이 높은 비율로 나타났으며, 울산의 경우 다른 지방에 비해 `기능노무`의 직업군이 비중이 높게 나타난 것을 확인할 수 있었다. 

결론적으로 본 보고서에서는, 직업별로 특정 분야에서의 여행자의 수가 많이 나타났다는 것을 알아볼 수 있다.





### 분석 주제

 국내여행 관광주간 등 현재 국내 여행에 관심을 촉구하려는 움직임이 나타나고 있다. 관심을 촉구하기 위해서는 먼저 국내 여행객들의 여행횟수 등 여행 실태에 관한 조사가 필수적이다. 이를 반영하여 지역별 국내 여행 횟수를 이용하여 과거의 국내여행자들의 여행횟수과 여행 특징을 파악하고자 한다.





### 데이터 선정

- 선정 이유 : 해외여행 데이터에 비교했을 때 국내 여행은 상대적으로 통계 내용이 국민들에게 잘 알려지지 않았기 때문에 해당 데이터를 선정했다. 또한, 해당 데이터에는 성별, 지역, 가구 소득 등과 같은 다양한 내용이 들어있기 때문에 선정하게 되었다.

- 출처 : 국가통계포털(KOSIS) 제공(국내통계-기관별 통계-중앙행정기관-문화체육관광부-국민여행 실태조사-여행 경험률 및 여행참가 횟수-여행지별 국내여행 참가자 수(2014~2016))<http://kosis.kr/index/index.do>

- 구성 : 2014년부터 2016년까지의 국내여행 참가자들을 대상으로 한 데이터이다. 대한민국 전국 시도별 국내 여행 참가자 수를 통계분류(1)와 그 하위항목 분류인 통계분류(2)로 자세히 나누었다.


        1. 국내 여행지(17곳) : 서울, 부산, 대구, 인천, 광주, 대전, 울산, 세종, 경기, 강원, 충북, 충남, 전북, 전남, 경북,                                경남, 제주
        2. 성별     (남자, 여자)
        3. 연령     (15세~19세, 20대, 30대, 40대, 50대, 60대 이상
        4. 직업     (전문관리, 사무, 서비스판매, 농어업, 기능 노무)
        5. 가구소득 (50만 원 미만, 50만~100만 원 미만, 100만~200만 원 미만, 200만~300만 원 미만, 300만~400만 원 미만,                         400만~500만 원 미만, 500만~600만 원 미만, 600만 원 이상)
        6. 학력     (초졸 이하, 중학교(재/졸), 고등학교(재/졸), 전문대(재/졸), 대학교(재/졸), 대학원(재/졸)



- 조사대상 범위 및 지역 : 가구 내 만 15세 이상 모든 가구원 조사 / 전국

- 조사주기 : 1년






##<본론-분석> 


 분석은 국가 통계 포털의 `여행지별 국내여행 참가 횟수(2014~)` 데이터를 이용하여 직업에 따라 국내 여행 참가 횟수가 차이가 있는지 알아보고자 한다. 더 나아가 분석 결과를 통해 직업군에 따라 여행 횟수에 어떠한 차이가 있으며, 그 이유는 무엇인지에 대해 생각해보고자 한다. 이 분석은 2가지의 방향을 가지고 분석을 진행하고자 한다.
 
 
              1. 직업군에 따라 특정 직업군의 평균 여행 횟수가 많을 것이다.
              2. 지역에 따라 특정 직업군의 여행 비율의 차이가 있을 것이다.

 
 다음의 분석은 데이터 파악 및 정제, 주제에 따른 데이터 가공, 그래프 생성 및 분석이라는 순서에 맞춰 진행할 것이다.
   

### 데이터 파악 및 정제
 이 순서에서는 분석에 사용할 데이터를 `readxl'패키지를 이용하여 불러들이고, `dplyr`패키지와 그밖의 다양한 R의 함수들을 사용하여 데이터를 정제하고자 한다. 


####데이터 불러오기

 분석할 데이터가 들어있는 자료를 살펴봤을 때, 확장자가 xlsx로 구성된 엑셀 파일이며 sheet명은 "데이터"이고 열이름(변수명)이 존재한다는 것을 알 수 있었다. 
 `readxl`패키지의 `read_excel()`함수를 이용하여 분석할 데이터를 R에 불러들인다. 추가적으로 `sheet`와 `col_names`파라미터를 이용하여 사용할 데이터의 위치를 확실히 하고, 변수명이 생성되도록 한다.
```{r}
library(readxl)
travel <- read_excel("travel2.xlsx", sheet = "데이터", col_names = T)
```


 데이터를 불러왔으니 이 데이터가 어떤 형태를 띄고 있는지 데이터 속성을 출력해주는 `str()`함수와 데이터의 앞부분을 확인할 수 있는 `head()`, 뷰어 창에서 데이터를 확인할 수 있는 `View()`함수를 이용하여 데이터의 속성을 확인한다.
```{r}
str(travel)
head(travel,20)
View(travel)
```


####데이터 정제하기


 `head()`,`str()`, `View()`함수를 통해 `travel`데이터를 파악한 결과 현재 `travel`데이터는 이상치가 존재하는 수정이 필요한 데이터라는 사실을 파악할 수 있었다. 이 데이터에서 `NA`값은 사라져서는 안되는 값이며 데이터를 불러오는 과정에서 생겨난 값이다. 그러므로 `NA`안에 그 안에 맞는 값을 넣어주려고 한다. 또한 `dplyr'패키지의 `rename()`함수를 이용하여 한국어로 되어있는 변수명을 영어로 바꿔 분석 시 용의하게 해주려 한다.
 
 데이터를 수정하기에 앞서 원본 데이터를 훼손하지 않기 위해 새로운 데이터에 원본 데이터를 넣고 시작한다.
```{r}
travel_new <- travel
```


 `dplyr`패키지의 `rename()`함수를 이용하여 travel_new 데이터의 변수명을 영어 변수명으로 바꾼다.
```{r, warning=FALSE}
library(dplyr)
travel_new <- rename(travel_new, sta1="통계분류(1)",
                     sta2="통계분류(2)",
                     area="항목",
                     year_2014="2014",
                     year_2015="2015",
                     year_2016="2016")
```


 변수명이 영어로 바뀐 것을 확인할 수 있다.
```{r}
head(travel_new)
```



 다음은 `NA`으로 처리된 공간에 대해 그에 알맞는 내용을 지정해주고자 한다. `sta1` 변수는 통계분류(1)로 총합, 성별, 연령, 직업, 소득, 학업에 대해 분류가 되어 있다. 그에 따라 `sta1`의 `NA`부분에 각 통계 분류에 맞는 내용을 할당한다. `sta2`변수는 통계분류(2)로  총합 대분류에 소계 소분류가 이뤄지고, 성별 대분류에 남,여 소분류, 연령대분류에 6가지의 연령 소분류, 직업 대분류에는 5가지의 소분류, 소득 대분류에는 8가지 소분류, 학업 대분류에 6가지의 소분류가 이뤄지고 있다. 그에 맞춰 `NA`에 각 부분에 맞는 내용을 할당한다.
 
 "데이터프레임명$변수명[행의 위치] <- 넣을 값" 형식으로 입력하면 빈 공간에 값을 넣을 수 있다.
```{r, message=TRUE, warning=FALSE}
travel_new$sta1[1:17] <- "total"
travel_new$sta1[18:51] <- "sex"
travel_new$sta1[52:153] <- "age"
travel_new$sta1[154:238] <- "job"
travel_new$sta1[239:374] <- "money"
travel_new$sta1[375:476] <- "school"

travel_new$sta2[1:17] <- "subtotal"
travel_new$sta2[18:34] <- "male"
travel_new$sta2[35:51] <- "female"
travel_new$sta2[52:68] <- "15-19"
travel_new$sta2[69:85] <- "20's"
travel_new$sta2[86:102] <- "30's"
travel_new$sta2[103:119] <- "40's"
travel_new$sta2[120:136] <- "50's"
travel_new$sta2[137:153] <- "60's"
travel_new$sta2[154:170] <- "전문관리"
travel_new$sta2[171:187] <- "사무"
travel_new$sta2[188:204] <- "서비스판매"
travel_new$sta2[205:221] <- "농어업"
travel_new$sta2[222:238] <- "기능노무"
travel_new$sta2[239:255] <- "50"
travel_new$sta2[256:272] <- "50-100"
travel_new$sta2[273:289] <- "100-200"
travel_new$sta2[290:306] <- "200-300"
travel_new$sta2[307:323] <- "300-400"
travel_new$sta2[324:340] <- "400-500"
travel_new$sta2[341:357] <- "500-600"
travel_new$sta2[358:374] <- "600"
travel_new$sta2[375:391] <- "초졸이하"
travel_new$sta2[392:408] <- "중학교(재/졸)"
travel_new$sta2[409:425] <- "고등학교(재/졸)"
travel_new$sta2[426:442] <- "전문대(재/졸)"
travel_new$sta2[443:459] <- "대학교(재/졸)"
travel_new$sta2[460:476] <- "대학원(재/졸)"
```


 데이터를 수정한 결과는 아래와 같다.
```{r}
str(travel_new)
head(travel_new,20)
View(travel_new)
```




### 1. 직업별 연도에 따른 국내여행 횟수 평균 비교
 이 데이터 안에는 2014년부터 2016년까지의 데이터를 수록하고 있다. 이를 바탕으로 년도별로 어느 직업군의 여행자가 여행을 많이 하고 있는지 파악하고자 한다. 이때 이용할 데이터는 평균적인 여행 횟수를 파악하기 위해 년도별 평균 여행 횟수를 이용한다.
 
 
####데이터 가공하기


 직업을 중심으로 하는 제한된 데이터를 사용하고, 평균 여행자 수를 사용하기 때문에 그에 맞는 데이터로 가공해야한다. `dplyr`패키지를 이용하여 데이터를 가공하고자 한다. 우선 `sta1`변수에서 `job`이 포함된 내용만 추출하기 위해 `filter()`함수를 이용한다. 그 뒤 `sta2`를 이용하여 직업군별로 묶고 `summarise()`함수를 이용하여 년도별 여행 횟수 총합과 평균을 구한다.
```{r}
library(dplyr)

job <- travel_new %>% 
  filter(sta1 == "job") %>%                                #직업별로 묶음
  group_by(sta2) %>% 
  select(sta2, year_2014, year_2015, year_2016) %>% 
  summarise(sum_2014=sum(year_2014),
            sum_2015=sum(year_2015),
            sum_2016=sum(year_2016),                          #년도별 총합
            mean_2014=mean(year_2014),
            mean_2015=mean(year_2015),
            mean_2016=mean(year_2016))                        #년도별 평균
```

 데이터를 가공한 결과는 아래와 같다.

5종류의 직업을 중심으로 년도별 총합과 평균 값이 나타나있다.
```{r}
job
```

 `job`데이터는 `x`축 직업을 기준으로 `y`축에 각각의 년도별 평균값을 넣는 그래프로 사용할 수 있다. 하지만 2014~2016년의 결과를 한번에 볼 수 있는 그래프를 만들기 원하기 때문에 아래와 같은 새로운 데이터를 가공하고자 한다. 

`job_year`데이터는 직업, 년도, 총합, 평균 4가지의 변수로 구성하며, 각각의 벡터는 `job`데이터를 이용한다.
```{r, warning=FALSE}
job_year <- data.frame(year= rep(c(2014,2015,2016),each=5),
                       job= rep(c("기능노무","농어업","사무","서비스판매","전문관리"),times=3),
                       sum= c(9511177,6270613,20872978,16667801,9481899,9494216,5860472,23108019,16992868,9629263,8971218,6601336,25680678,18204393,9849370),
                       mean= c(559481.0,368859.6,1227822.2,980458.9,557758.8,558483.3,344733.6,1359295.2,999580.5,566427.2,527718.7,388313.9,1510628.1,1070846.6,579374.7))
```

 결과는 다음과 같다.

```{r}
job_year
```


####그래프로 나타내기
 먼저 각각의 연도별 평균 여행 횟수를 파악하기 위해 `job`데이터를 이용하여 `x`축에 직업, `y`축에 연도별 평균을 넣어 막대그래프를 만들었다. 그래프로 나타내기 위해 `ggplot2`패키지를 이용하였다. 
 
```{r}
library(ggplot2)

ggplot(data = job, aes(x=sta2, y=mean_2014)) + geom_col() + ggtitle("2014년 직업별 평균 여행 횟수")
ggplot(data = job, aes(x=sta2, y=mean_2015)) + geom_col() + ggtitle("2015년 직업별 평균 여행 횟수")
ggplot(data = job, aes(x=sta2, y=mean_2016)) + geom_col() + ggtitle("2016년 직업별 평균 여행 횟수")
```

나타난 그래프를 살펴보았을 때, 모두 "사무", "서비스판매"의 경우 모든 연도에서 1위와 2위를 차지하며, "농어업"은 모든 연도에서 제일 게 나타났다. 이를 제외한 " 전문관리", "기능노무"은 평균이 비숫하게 나타나고 있음을 확인할 수 있었다. 


 3년간 직업별 평균 여행 횟수를 한눈에 파악하기 위해 `ggplot2`패키지를 이용하여 그래프를 만들었다. `x`축은 직업, `y`축은 년도별 평균 여행 횟수로 하며 `fill`파라미터를 이용하여 년도별로 색깔을 달리 나타내어 한 그래프에서 3년간 직업별 평균 여행 횟수를 보이도록 하였다. 또한 구분을 확실하게 하기위해 `geom_col()`를 사용하여 막대그래프로 나타냈다.
```{r, warning=FALSE}
library(ggplot2)
ggplot(data = job_year, aes(x=job, y=mean, fill=year)) + geom_col() + ggtitle("연도에 따른 직업-평균 여행횟수")
```

```{r}
job %>% 
  select(sta2, mean_2014, mean_2015, mean_2016)
```
 
 그래프와 표를 비교해서 분석해볼 때, 년도별로는 평균 여행 횟수가 크게 차이가 없다는 것을 파악할 수 있었다. 하지만 직업에 따라서 평균 여행 횟수가 차이가 "사무", "서비스판매", " 전문관리", "기능노무", "농어업" 순으로 많게 나타났다. 이는 직업의 특성에 근거하여 이유를 찾을 수 있었다. 주 몇일 근무가 확실하고 휴일이 많은 사무직, 서비스판매직의 경우 평균 여행 횟수가 높게 나타난 반면 휴일의 구분이 없이 일하는 농어업의 경우 결과가 낮게 나타났다. 이는 휴일이 확실히 정해져 있는 직업군의 경우 더 많이 여행을 다닌다고 결론 내릴 수 있다.



### 2. 직업별 여행지에 따른  국내 여행자 수의 비율 비교
 이 데이터 안에는 17개의 시, 도의 여행지가 수록되어 있으며 그에 따른 여행 횟수가 나타나 있다. 이를 바탕으로 여행지별로 어느 직업군의 여행자가 여행을 많이 하고 있는지 파악하고자 한다. 여기서는 한 지역의 여행 횟수를 100%로 하는 직업별 여행지에 따른 국내 여행자 수의 비율을 비교하고자 한다. 이를 통해 어느 지역에 어떤 직업의 여행자가 더 많은 비중을 차지하는지 파악할 수 있다.
 
####데이터 가공하기


 직업을 중심으로 하는 제한된 데이터를 사용하고, 지역에 따른 여행 횟수의 비율을 사용하기 때문에 그에 맞는 데이터로 가공해야 한다. `dplyr`패키지를 이용하여 데이터를 가공하고자 한다.
 
 우선 `sta1`변수에서 `job`이 포함된 내용만 추출하기 위해 `filter()`함수를 이용한다. 그 뒤 `group_by()`를 이용해 지역별로 묶은 뒤 `mutate()`함수를 이용하여 지역별 총 여행 횟수를 나타내는 `tot_area`와 지역별 여행 횟수 비율을 나타내는 `ratio` 두 변수를 생성한다. 
```{r}
library(dplyr)

job2 <- travel_new %>% 
  filter(sta1 == "job") %>% 
  group_by(area) %>% 
  select(area,sta2, year_2014, year_2015, year_2016) %>% 
  mutate(tot_area=sum(year_2014,year_2015,year_2016),
         ratio=(year_2014+year_2015+year_2016)/tot_area*100) %>% 
  arrange(area)
```

 데이터 가공 결과, 지역을 중심으로 하여 지역별 총합과 지역별 여행 횟수 비율을 나타내는 변수가 생성되었음을 확인할 수 있다.
```{r}
job2
```


####그래프로 나타내기


 위에서 가공한 데이터를 한눈에 파악하기 위해 `ggplot2`패키지를 이용하여 그래프를 만들고자 한다. `x`축에는 지역, `y`축에는 비율을 나타내고, 직업에 따라 색깔을 다르게 표현할 수 있는`fill`파라미터를 이용하여 비율그래프를 나타내고자 한다. 추가적으로 비율 그래프를 더 깔끔하게 보이게 하기 위해 `x`축과 `y`축의 위치를 변경하는 `coor_flip()`를 이용한다.
```{r, warning=FALSE}
ggplot(data = job2, aes(x=area, y=ratio, fill=sta2)) +
  geom_col() + 
  coord_flip() + 
   scale_x_discrete(limits=c("서울","부산","대구","인천","광주","대전","울산","세종","경기","강원","충북","충남","전북","전남","경북","경남","제주")) +
  ggtitle("지역에 따른 직업-평균 여행횟수")
```
 
 나타난 결과 그래프를 보면 지역에 따라 대체적으로 비슷한 직업별 여행 비율이 나타난 다는 것을 확인할 수 있었다. 
 
 하지만 그 중 광주의 경우 다른 지역에 비해 `농어업`직업군이 높은 비율로 나타났다. 광주의 위치지도와 특징을 살펴볼 때 광주의 경우 평야지대에 위치하여 농경지가 많이 있는 호남지방에 위치하고 있었다. 이를 통해 광주의 경우 주변의 농어업 종사자들이 가까운 대도시인 광주로 여행을 왔기 때문에 비율이 높게 나타난 것이라고 생각할 수 있었다. 
 
 또한 울산의 경우 다른 지방에 비해 `기능노무`의 직업군이 비중이 높게 나타난 것을 확인할 수 있었다. 울산의 특징을  살펴보았을 때 울산은 공업이 많이 발달한 지역임을 확인할 수 있었다. 이에 따라 기술직을 뜻하는 기능노무 종사자들이 울산과 그 주변지역에 많이 분포하고 있을 것라 판단하였고, 그렇기에 그 주변의 대도시인 울산으로 기능노무 종사자들이 여행을 많이 왔기 때문에 비율이 높게 나타난 것이라고 생각할 수 있었다.
 
 
 


## <결론>


지금까지의 데이터 분석으로 우리는 2014~2016년 국내 여행지와 연도별 여행객의 특징들을 살펴볼 수 있었다. 직업별로 여행객을 구분하고 분석한 결과,  "1. 직업군에 따라 특정 직업군의 평균 여행 횟수가 많을 것이다.", "2. 지역에 따라 특정 직업군의 여행 비율의 차이가 있을 것이다."라는 두가지 가설에 대한 결과를 얻을 수 있었다. 

첫번째 가설의 경우 "사무"직에 해당하는 여행객의 여행 횟수가 가장 높게 나타나 특정 직업군의 평균 여행 횟수가 높다는 것을 파악할 수 있었다. 이를 통해 일정하게 일하고 쉬는 날이 있는 "사무"직이 여행을 많이 다닌다고 추측할 수 있었다. 또한 "농어업" 종사자의 경우 평균 여행 횟수가 제일 낮게 나타났으며 사무직과 큰차이가 있었다. 이로 보아 쉬는 날이 없고 일하는 날에 대한 구분이 적기 때문에 휴일리 적기 때문에 여행을 적게 다닌 것이라고 추측할 수 있었다.

두번째 가설의 경우 "울산"과 "광주"에서 다른 지역의 비율 그래프와 달리 "기능노무"와 "농어업"의 비율이 많이 나타남을 확인할 수 있었다. 이를 지역적 특징과 연계하여 분석했을 때, "울산"의 경우 공업이 몰려있는 지역이기 때문에 "기능노무" 종사자의 여행비율이 높게 나타나며 "광주"의 경우 평야, 농촌이 많이 분포되어 있는 지역이기 때문에 "농어업" 종사자의 여행비율이 높게 나타났다고 추측할 수 있었다. 

이를 통해 2가지의 가설에 맞는 결과를 확인하여, 직업에 따라 여행횟수가 달리 나타나며, 지역에 따라 특정 직업의 종사자들이 그 지역으로 여행을 많이 온다는 결론을 얻을 수 있었다.

###한계점 및 비판점, 추후 분석 방향
 이번 분석의 한계점으로는 크게 두가지가 존재한다. 
 
 첫째, 이번에 사용한 데이터는 여행지별 국내 여행 횟수 데이터로 모든 횟수를 합한 값이 나타나 있기 때문에 다른 통계분류와의 연계성이 부족하다는 점이다. 이러한 점은 통계자료가 아닌 통계 자료를 만들기 전 원본 데이터를 이용하는 경우에 해결할 수 있다. 
 
 두번째, 특정 지역과 직업에 대한 여행 횟수만으로는 국내 여행자들에 대한 다양한 분석이 불가능 하다. 어느 직업의 종사자의 1년 평균 여행 횟수에 대해 파악할 수 없으며, 특정 지역의 특정 직업 종사자들이 다른 어느 지역으로 여행을 많이 가는지에 대한 분석 등 다양한 분석이 불가능하다. 그렇기에 여행 실태 조사의 다른 통계 데이터를 이용하여 다양한 분석을 할 필요가 있다. 

 이를 통해 국내 여행객들에 대한 다양한 분석을 실시하여 초기에 국내 여행자들의 특성을 파악있하고자 한 목적을 이뤄 결과적으로 국내 여행을 증가시키거나 발전시키는 방안을 찾는 근거로 사용할 수 있도록 할 것이다. 

